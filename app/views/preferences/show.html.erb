<div class="container mx-auto px-4 py-8">
  <div class="mb-6">
    <div class="flex justify-between items-center">
      <h1 class="text-3xl font-bold text-gray-900"><%= @category.name %></h1>
      <%= link_to "← Back to Categories", preferences_path, class: "text-blue-600 hover:text-blue-800" %>
    </div>
    <p class="text-lg text-gray-600 mt-2"><%= @category.description %></p>
  </div>

  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-8">
    <div class="px-6 py-4">
      <h2 class="text-xl font-semibold mb-4">Current Preferences</h2>
      
      <% @category.preference_questions.ordered.each do |question| %>
        <div class="mb-6 pb-4 border-b border-gray-200 last:border-0">
          <div class="flex justify-between">
            <h3 class="font-medium text-gray-900"><%= question.label %></h3>
            <span class="text-sm text-gray-500"><%= question.key %></span>
          </div>
          
          <% if question.description.present? %>
            <p class="text-gray-600 text-sm mt-1"><%= question.description %></p>
          <% end %>
          
          <div class="mt-2">
            <% stored_value = @preferences[question.key] %>
            <% display_value = stored_value.present? ? stored_value : question.default_value %>
            
            <% case question.question_type %>
            <% when 'boolean' %>
              <span class="px-3 py-1 text-sm rounded-full <%= display_value.to_s == 'true' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800' %>">
                <%= display_value.to_s == 'true' ? 'Yes' : 'No' %>
              </span>
            <% when 'select', 'radio' %>
              <span class="px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-800">
                <%= display_value %>
              </span>
            <% when 'checkbox' %>
              <div class="flex flex-wrap gap-2">
                <% (display_value.is_a?(String) ? JSON.parse(display_value) : display_value).each do |item| %>
                  <span class="px-3 py-1 text-sm rounded-full bg-purple-100 text-purple-800">
                    <%= item %>
                  </span>
                <% end %>
              </div>
            <% when 'textarea' %>
              <pre class="mt-2 whitespace-pre-wrap text-sm p-3 bg-gray-50 rounded"><%= display_value %></pre>
            <% else %>
              <span class="text-gray-900"><%= display_value %></span>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    
    <div class="px-6 py-3 bg-gray-50 border-t border-gray-200">
      <%= link_to "Edit Preferences", edit_preference_path(@category.name), class: "text-green-600 hover:text-green-800 font-medium" %>
    </div>
  </div>
  
  <div class="bg-blue-50 p-6 rounded-lg">
    <h2 class="text-xl font-semibold text-blue-800">API Access</h2>
    <p class="mt-2 text-blue-700">
      These preferences are accessible via the MCP protocol at:
      <code class="bg-blue-100 px-2 py-1 rounded text-blue-900"><%= request.base_url %>/mcp</code>
    </p>
  </div>
</div>
